cmake_minimum_required(VERSION 3.8)

if (NOT WIN32)
    include(FetchContent)
    FetchContent_Declare(
        fmt
        GIT_REPOSITORY https://github.com/fmtlib/fmt
        GIT_TAG b50e685db996c167e6c831dcef582aba6e14276a
    ) # 11.0.1
    FetchContent_MakeAvailable(fmt)
endif()

project(main)
set(CMAKE_CXX_STANDARD 20)

if (MSVC)
    # Исходный код сохранен в UTF-8 без BOM. MSVC определяет кодировку
    # расширенного набора символов по BOM. Поэтому используется текущая
    # кодировка пользователя 1251 и вывод портится.
    add_compile_options(/utf-8)
endif()

file(GLOB_RECURSE SOURCES RELATIVE ${CMAKE_SOURCE_DIR} "src/*.cpp")
add_executable(main ${SOURCES})

if (WIN32)
    add_compile_definitions(OS_WINDOWS)
else()
    add_compile_definitions(OS_LINUX)
endif()

if (NOT WIN32)
    target_link_libraries(main fmt::fmt)
endif()
